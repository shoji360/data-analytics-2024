# データアナリティクスII-2024
本ページは、「データアナリティクスII」（莊司担当パート）の資料置き場です。

この内容は順次更新されます。


## 開講情報
* 実施時期：静岡大学 情報学部 行動情報学科 3年次
* 日時：前期月曜4-5コマ（14:25-17:35）
* 場所：共31

## 成績評価（莊司担当パート）
莊司担当パートでは、本授業科目の約33％の成績を評価します（残り67％は金先生、大島先生パートで評価）。
評価は以下の2つの観点から行います。
* レポート課題（莊司担当パート100％）
* 授業参加への積極性（追加得点）
	* 各回の提出物（出席扱い）
	* ノックの進行状況、質問サポートDocへの書き込み

## 第1回のサポート情報
* 教材、課題のダウンロードなど：
  * [今見ているこのサイト](https://shoji-lab.jp/da2024.html)
* グループ登録
  * [Google Forms](https://forms.gle/MHVVHXQ4jEHif8Mm8)
  * グループのどちらか、代表者が登録してください
* 質問や補足を書き込み可能な授業ノート
  * [Google Docs](https://docs.google.com/document/d/1queZ1HAJuPnGsRLk-FznuuHPRp2eHFEZwzbzEn8t2tU/edit?usp=sharing)
  * （編集にはGoogleアカウントが必要）
* 本日すること
  * 下記のリンク先から、「課題0」の内容に従って下さい
  * 3枚のシートを含むエクセルファイルを作成し、学務情報システムから提出してください
  * 提出可能時間は本日16:00～24:00です。
    * *出席確認を兼ねています。途中でも提出してください！*

## 第2回のサポート情報
* 質問や補足を書き込み可能なノート
* [Google Docs](https://docs.google.com/document/d/1BZ-N7-3F5TrLovo4VMv2dpEjsUUkuAovmixRsj5iUMQ/edit?usp=sharing)
* 本日すること
  * 下記の「Jupyter Notebook」ファイルをダウンロードし、Google Colabにアップロードしてください。
  * Google Colab内で、ノックを解いていってください。
  * できたところまでを学務システムにレポートとして提出してください。
    * 提出可能時間は本日16:00～24:00です。
    * 出席確認を兼ねています。進捗度合は成績に加味されません。途中でも出してください。

## 授業の予定とコンテンツ（莊司担当パート）
* **本確定ではありません！今後変更の可能性があります**
  * 先の回のドリルは予習に使って大丈夫ですが、授業当日までに変更されることが予想されます。
* 授業用ファイルは、リンクを単にクリックせずに、右クリックで「名前を付けて保存」してください


| |  日時  | トピック | 講義資料 | 課題&ドリル | 授業用ファイル |
| ---- | ---- | ---- | ---- | ---- | ---- |
| 第1回 | 4月15日（月） | BadData, not BigData | [PPT](https://www.dropbox.com/scl/fi/661qahtw8104huixwtegx/II-1.pptx?rlkey=jmxsjxcngauxukid07qvm1pdk&dl=0) | [nbviewer](https://nbviewer.org/github/shoji360/data-analytics-2024/blob/main/notebook/day-01.ipynb) |<a href="https://shoji-lab.jp/day1-dataset.zip" download="day1-dataset.zip">zip download</a>|
|第2回|4月22日（月）|BigData|[PPT](https://www.dropbox.com/scl/fi/zf2xh692jo92g39dhemnj/II-2.pptx?rlkey=dr0ev6zrqgp5lkmejlp8315pa&dl=0)|[nbviewer](https://nbviewer.org/github/shoji360/data-analytics-2024/blob/main/notebook/day-02.ipynb)|[DBファイル](https://shoji-lab.jp/data-analytics-lecture.zip), <a href="https://shoji-lab.jp/day-02.ipynb" download="day-02.ipynb">ipynbファイル</a>|



## レポート課題
* 本確定ではありません

関係データベースを利用して購買データを管理している仮想の小売店（杏森堂）から、データ分析の依頼を受けたとする。[レポート課題用ページ（URL）](https://nbviewer.org/github/shoji360/data-analytics-2022/blob/main/notebook/FianalReport.ipynb)に掲載された課題について、回答を作成しなさい。回答は1つのPDFファイルにまとめ、下記の要領で期日までに提出してください。

* 締め切り：最終回の１週間後24時
* 提出形式：PDFファイル
    * レポートのテンプレートは[コチラのURL](https://shoji-lab.jp/da2_report.docx)にあるものをダウンロードして使用すること
    * ファイル名は「学籍番号.pdf」とせよ）
* 提出方法：学務情報システム経由

ipynb形式のノートをダウンロードして使いたい場合は
[右クリックで保存](https://shoji-lab.jp/Report.ipynb "download")




<!-- ### 課題0（Day 1より）
杏森堂では、顧客台帳をExcelフォーマットを使って管理している。売上は順調であり、Excelのデータがかなりのボリュームになっているため、データ分析を行うことで色々な知見が期待できる。

杏森堂からデータ分析の依頼を受けたとしよう。[こちらのOneDrive（要Office365アカウント）](https://scii-my.sharepoint.com/:f:/g/personal/yusuke_yamamoto_cii_shizuoka_ac_jp/Egffkcr-VBRDrMpGG-4uc1UB2jv9B7Uh9omCkUmc-RUigA?e=2fgjQh)には、杏森堂の売上に関する以下の4つのファイルが格納されている：
* 購買記録に関するデータ（2019年1月〜2019年7月の売上履歴）
    * uriage_1.csv
    * uriage_2.csv
* 顧客台帳データ（手入力で店舗が管理している顧客台帳）
    * kokyaku_daicho_1.csv
    * kokyaku_daicho_2.csv

2つのファイルを用いて、以下に関する表を作成せよ：
1. 縦方向にある年のある月、横方向に商品を並べた、商品ごとの年月別売上情報
2. 縦方向にある年のある月、横方向に地域（市）を並べた、各市ごとの年月別売上情報
3. 集計期間中（2019年1月〜2019年7月）に杏森堂で購買行動をしていない顧客のリスト -->


<!-- ### 課題1（Day 2より）
杏森堂から提供された購買履歴が格納されたデータベースを用いて、これまでに何名の顧客が何回（何日）ショッピングを行ったのかを分析したい。

レシート明細テーブル（`receipt`）を用いて顧客の購買頻度を分析し、以下の項目について分析結果を表示するSQL文を書き、実行結果とともに示しなさい：
* 購買頻度（これまでに店舗を利用した日数）
* 購買頻度に対応する顧客の数
* 該当する購買頻度以下の顧客数の累積値

ただし、顧客ID（`customer_id`）が"Z"から始まるのものは非会員を表すため、除外して分析すること。

※ 以下は、SQL実行結果のイメージである：

| 購買頻度（日数） | 購買頻度に対応する顧客の数 | 顧客数累積値 |
| ---- | ---- | ---- |
| 1 | 2761 | 2761 |
| 2 | 1499 | 4260 |
| 3 | 881 | 5141 |
| ... | ... | ... |


### 課題2（Day 3より）
課題2-1、課題2-2のいずれかを選択し、結果を得るためのSQL文を書き、実行結果とともに示しなさい。

#### 課題2-1: 月別売上の対昨年比
レシート明細テーブル（`receipt`）には2017年1月から2019年10月の間の購買情報が記録されている。2017年から2019年までの期間の売上を把握するために、1ヶ月ごとに以下の情報を集約表示せよ：
* 年月（`year_month`）
* 購買回数（`purchase_freq`）
* 購買1回あたりの平均購入額（`avg_amount_per_purchase`）
* 月間売上高（`total_amount`）
* 当該月の前年売上高（`total_amount_last_year`）
* 売上の対前年比（`ratio`）

※ 以下は、SQL実行結果のイメージである：

| year_month | purchase_freq | avg_amount_per_purchase | total_amount | total_amount_last_year | ratio |
| ---- | ---- | ---- | ---- | ---- | ---- |
| 2017-01 | 1405 | 902056 | 642 | NULL | NULL  |
| 2017-02 | 1219 | 764413 | 627 | NULL | NULL  |
| ... | ... | ... | ... | ... | ... |
| 2017-12 | 1467 | 939654 | 640 | NULL | NULL  |
| 2018-01 | 1473 | 944509 | 641 | 902056 | 1.05 |
| 2018-02 | 1387 | 864128 | 623 | 764413 | 1.13 |
| ... | ... | ... | ... | ... | ... |
| 2019-10 | 1750 | 1143062 | 653 | 1069939 | 1.07 |

#### 課題2-2: ABC分析
ABC分析は販売戦略を考えるために、売上によって商品をランク付けする手法である。
一般に、ABC分析では売上総額の
* 上位0〜70％の商品をAランク
* 上位70〜90％の商品をBランク
* 上位90〜100%の商品をCランク

とするランク付けを行う。

商品カテゴリ「菓子（`category_major_cd = 08`）」に属する商品について、小区分（`category_small_name`）ごとに売上を集計し、菓子カテゴリの売上総額に占める割合（構成比）を計算せよ。
また、売上がN位の小区分の行には売上額上位N位までの構成比累計、および構成比累計に基づくABC分析のランク付け結果も表示せよ。

※ 以下は、SQL実行結果のイメージである：

| カテゴリ名 | 売上 | 構成比 | 累積構成比 | ランク |
| ---- | ---- | ---- | ---- | ---- |
| 煎餅 | 194211 | 0.1306 | 0.1306 | A |
| 菓子詰め合わせ | 129580 | 0.0871 | 0.2178 | A |
| ナッツ類 | 129020 | 0.0867 | 0.3046 | A |
| ... | ... | ... | ... | ... |
| キャンディー | 46177 | 0.0310 | 0.7208 | B |
| ... | ... | ... | ... | ... |
| その他珍味 | 24086 | 0.0162 | 0.9073 | C |
| ... | ... | ... | ... | ... |


### 課題3（Day 4より）
#### 課題3-1
顧客ごとに購買頻度（購買回数）を求め、購買頻度の分布を説明するためのグラフを作成せよ。また、グラフから読み取れることを文章で記述せよ。ただし、顧客ID（`customer_id`）が"Z"から始まるのものは非会員を表すため、除外して分析すること。

なおレポートには、顧客ごとに購買頻度（購買回数）を求めるためのSQL文も付しておくこと（SQL文の実行結果は掲載する必要なし）。

#### 課題3-2
都道府県別に年月別の売上総額を求め、その売上総額の変化を比較するためのグラフを作成せよ。また、グラフから読み取れることを文章で記述せよ。

なおレポートには、都道府県別の年月別売上総額を求めるためのSQL文も付しておくこと（SQL文の実行結果は掲載する必要なし）。

#### 課題3-3
顧客一人あたりの売上総額の分布を、千葉県の店舗ごとに比較するためのグラフを作成せよ。また、グラフから読み取れることを文章で記述せよ。ただし、顧客ID（`customer_id`）が"Z"から始まるのものは非会員を表すため、除外して分析すること。

なおレポートには、店舗ごとにその店舗を利用した各顧客の売上総額を集計するSQL文も付しておくこと（SQL文の実行結果は掲載する必要なし）。


#### 課題3-4
千葉県にある店舗間で顧客が購入する菓子の傾向が異なるかどうかを分析したい。千葉県にある店舗と菓子の中カテゴリ（cateogory_medium_cd）ごとに菓子の購入量（個数）を集計し、購入された菓子の中カテゴリの内訳を店舗間で比較するためのグラフを作成せよ。また、グラフから読み取れることを文章で記述せよ。

なおレポートには、購入量を集計するためのSQL文も付しておくこと（SQL文の実行結果は掲載する必要なし）。


### 課題4
データアナリティクスIIの莊司担当パートについて、良かった点および改善すべき点を記しなさい。 -->